# BMAD: Redis RDB Persistence Configuration

**Story:** 1.2 - Docker Compose Setup, 2.5a - Redis Checkpointing
**Date:** 2025-10-28
**Severity:** High (Missing AC requirement)
**Status:** ✅ FIXED - RDB + AOF configured

---

## Behavior

### Missing Requirement

**Story 1.2 AC#8**: "Redis RDB persistence enabled"
**Epic 2 Story 2.5a AC#5**: "RDB snapshots every 15 minutes"

**Before Fix**:
```yaml
redis:
  image: redis/redis-stack:latest
  # No command - using Redis Stack defaults only
```

Result: Checkpoints lost on Redis restart.

---

## Act

### Solution Implemented (2025-10-28)

```yaml
redis:
  image: redis/redis-stack:7.4.0-v0
  command: >
    redis-server
    --save 900 1
    --save 300 10
    --save 60 10000
    --appendonly yes
```

**Configuration**:
- `--save 900 1`: Save if ≥1 key changed in 15 minutes
- `--save 300 10`: Save if ≥10 keys changed in 5 minutes
- `--save 60 10000`: Save if ≥10000 keys changed in 1 minute
- `--appendonly yes`: AOF for additional durability

---

## Document

### Validation

```bash
$ docker exec atrevete-redis redis-cli CONFIG GET save
save
900 1 300 10 60 10000

$ docker exec atrevete-redis redis-cli CONFIG GET appendonly
appendonly
yes
```

**Impact**: ✅ Checkpoints survive Redis restart, AC#8 satisfied
**Epic 2 Readiness**: ✅ Story 2.5a crash recovery testing now possible

**References**: BMAD 1.5b, Story 1.2 AC#8, Story 2.5a AC#5
